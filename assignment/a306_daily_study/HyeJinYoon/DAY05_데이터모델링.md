# 데이터 모델링

- 데이터베이스나 소프트웨어 시스템에서 데이터를 구조화하고 조직화하여 데이터의 구조와 관계를 시각적으로 표현하는 방법

- 데이터가 어떻게 저장, 연결, 액세스 및 관리될지 정의하여 시스템이 효율적이고 효과적으로 작동하도록 해야 한다.

### 목적

- 데이터 구조 설계
  
  - 데이터를 체계적으로 정의하고 구성

- 요구사항 반영
  
  - 시스템 요구사항을 데이터 설계에 반영

- 일관성 및 효율성 확보
  
  - 데이터 중복 제거와 최적화를 통해 성능을 향상

- 의사소통 도구
  
  - 개발자, 설계자, 비즈니스 관계자 간에 데이터 의미와 구조를 쉽게 공유

### 주요 단계

1. 요구사항 분석
   
   - 시스템의 요구사항을 이해하여 사용자가 필요로 하는 데이터와 그 데이터 간의 관계를 파악한다.

2. 개념적 데이터 모델링 (Conceptual Data Modeling)
   
   - 데이터의 큰 그림을 나타냄
   
   - 비즈니스 관점에서 엔터티(Entity)와 관계(Relationship)를 정의
   
   - 주로 ERD(Entity-Relationship Diagram)로 표현
     
     - ERD 작성 툴(사이트) : MySQL Workbench, ER/Studio, Lucidchart, Visual Paradigm, dbdiagram.io 등

3. 논리적 데이터 모델링 (Logical Data Modeling)
   
   - 데이터 구조의 세부 사항을 정의
   
   - 테이블, 컬럼, 데이터 유형 등의 논리적 구성을 설계
   
   - 데이터 정규화를 통해 데이터 중복 제거와 무결성을 강화

4. 물리적 데이터 모델링 (Physical Data Modeling)
   
   - 실제 데이터베이스에 구현할 모델을 설계
   
   - 데이터베이스의 특성(DBMS에 따라)을 고려하여 테이블, 인덱스, 키 등을 정의

### 용어 정리

- 엔티티(Entity)
  
  - 데이터 모델에서 나타내는 주요 객체, 예: 학생, 주문, 제품

- 속성(Attribute)
  
  - 엔티티가 가지고 있는 특성, 예: 학생의 이름, 주문 날짜

- 관계(Relationship)
  
  - 엔티티 간의 연결 또는 연관성, 예: 학생이 강의를 수강한다

- 키(Key)
  
  - 데이터를 고유하게 식별하는 요소.
    - 기본 키(Primary Key) : 각 행을 고유하게 식별
    - 외래 키(Foreign Key) : 다른 테이블과의 관계를 정의

- 정규화(Normalization)
  
  - 데이터 중복과 이상현상(Anomaly)을 줄이기 위해 데이터를 정리
  
  - 1NF, 2NF, 3NF, BCNF 등이 있다.

- 비정규화(Denormalization)
  
  - 데이터베이스의 성능을 향상시키기 위해 하나 이상의 테이블에 데이터를 중복시키거나 그룹핑하는 최적화 기법

- 이상현상(Anomaly)
  
  - 테이블을 설계할 때 잘못 설계하여 데이터를 삽입, 삭제, 수정할 때 논리적으로 생기는 오류
  
  - **삽입 이상(Insertion Anomaly)**: 데이터를 추가하려고 할 때 불필요한 데이터가 필요
  
  - **삭제 이상(Deletion Anomaly)**: 데이터를 삭제할 때 필요한 데이터가 손실
  
  - **갱신 이상(Update Anomaly)**: 데이터 중복으로 인해 일부만 갱신하면 불일치 발생

- 데이터 무결성
  
  1. 개체 무결성 (Entity Integrity)
     
     - 테이블의 기본 키(Primary Key)는 고유해야 하며, NULL 값을 허용하지 않는다.
  
  2. 참조 무결성 (Referential Integrity)
     
     - 테이블 간의 관계를 유지하도록 데이터의 일관성을 보장한다.
     
     - 외래 키를 사용해 테이블을 연결하여 한 테이블의 값이 수정/삭제되면 다른 테이블도 함께 변동되어야한다.
  
  3. 도메인 무결성 (Domain Integrity)
     
     - 열(Column)의 데이터가 정의된 도메인(값의 범위, 허용 범위, 규칙 등)을 만족해야 한다.
  
  4. 고유성 무결성 (Unique Integrity)
     
     - 특정 컬럼이나 컬럼 조합의 값이 중복되지 않도록 보장해야 한다. => 정규화의 한 부분
  
  5. 업무 규칙 무결성 (Business Rule Integrity)
     
     - 비즈니스 로직에 따른 데이터의 일관성을 유지해야 한다.

### 정규화 vs 비정규화

- 정규화 : 데이터베이스를 설계할 때 데이터 중복을 최소화하고 데이터 무결성을 유지하기 위한 방법론

- 정규화의 목적 : 데이터 중복 제거, 이상현상(Anomaly) 제거, 데이터 무결성 유지

- 정규화의 단계
  
  - 1NF (제1정규형) : 원자값(Atomic Value)
    
    - 모든 속성이 더 이상 쪼갤 수 없는 원자값이어야 한다.
    
    > 비정규형: `과목 = "수학, 과학"`
    > 
    > 1NF: `과목 = "수학"`, `과목 = "과학"` (각 값이 분리됨)
  
  - 2NF (제2정규형) : 부분 함수 종속 제거
    
    - 기본 키의 **일부**가 아닌 **전체**에 종속된 속성만 허용
    
    - 1NF를 만족하면서, 비주요 속성이 기본 키의 부분 집합에 종속되지 않아야 한다.
    
    > 기본 키: `학생ID + 과목`
    > 
    > 비주요 속성: `학생 이름` → 부분 종속 제거 후 `학생` 테이블 분리.
  
  - 3NF (제3정규형) : 이행적 함수 종속 제거
    
    - 비주요 속성이 다른 비주요 속성을 통해 간접적으로 기본 키에 종속되지 않아야 한다.
    
    > `학생ID → 학과 → 학과 위치` → `학과`와 `학과 위치`를 별도 테이블로 분리.
  
  - BCNF (Boyce-Codd 정규형) : 모든 결정자가 후보 키
    
    - 3NF보다 더 엄격한 조건으로, 후보 키가 아닌 결정자를 모두 제거한다.
  
  - 4NF, 5NF : 다치 종속 제거, 조인 종속 제거
    
    - 복잡한 관계를 처리하며, 실무에서 자주 사용되지는 않는다.

- 정규화 장점 : 
  
  - 데이터 중복 제거
  
  - 데이터 무결성 및 일관성 유지
  
  - 데이터 저장 공간 절약

- 정규화 단점 :
  
  - 테이블이 많아져 조인(Join)이 복잡해지고 성능 저하 가능

---

- 비정규화 : 정규화를 통해 분리된 테이블을 다시 병합하거나, 데이터 중복을 허용하여 조회 성능을 향상시키는 방법

- 비정규화의 목적
  
  - 조회 성능 향상 : 조인(Join) 연산을 줄여 쿼리 속도를 높임
  
  - 데이터 액세스 단순화 : 데이터를 한 테이블에서 빠르게 조회 가능
  
  - 애플리케이션 요구사항 대응 : 정규화된 구조로는 해결하기 어려운 성능 문제를 해결

- 비정규화 방법
  
  - 테이블 병합 : 자주 함께 조회되는 테이블을 합친다.
  
  - 중복 데이터 추가 : 데이터 조회 속도를 위해 일부 데이터를 여러 테이블에 중복 저장한다.
  
  - 계산된 데이터 추가 : 합계나 평균 등 계산 결과를 테이블에 저장한다.

- 비정규화 장점 :
  
  - 조회 속도 향상
  
  - 애플리케이션 복잡도 감소

- 비정규화 단점 :
  
  - 데이터 중복으로 저장 공간 증가.
  
  - 데이터 무결성 유지가 어려움.
  
  - 수정/삭제 시 데이터 불일치 가능성 증가.

- 정리

| **항목**     | **정규화**           | **비정규화**         |
| ---------- | ----------------- | ---------------- |
| **목적**     | 데이터 중복 제거, 무결성 유지 | 성능 최적화, 조회 속도 향상 |
| **테이블 수**  | 많아짐               | 줄어듦              |
| **조인 연산**  | 자주 발생             | 줄어듦              |
| **데이터 중복** | 최소화               | 허용               |
| **무결성 관리** | 쉬움                | 어려움              |
| **적용 상황**  | 데이터 무결성이 중요한 경우   | 성능이 중요한 경우       |

- **정규화**는 데이터베이스 설계의 기본 원칙으로 초기 설계 단계에서 주로 적용된다.

- **비정규화**는 성능 문제(특히 조회 속도 저하)가 발생할 때 선택적으로 사용된다.

- 두 접근 방식을 **혼합**하여 사용하는 것이 일반적이다. 먼저 정규화를 적용한 뒤, 성능 병목 지점을 분석하여 비정규화를 도입한다.

### DB 설계 방법

- 하향식(TOP-DOWN)
  
  - 큰 개념에서 출발하여 점차 세부적인 요소로 구체화하는 방법
  
  - 시스템의 전체적인 구조를 먼저 설계하고, 이를 세분화하여 엔터티, 속성, 관계를 정의한다.
  
  - 장점
    
    - 전체적인 관점에서 설계하므로 시스템의 일관성을 유지하기 쉽다.
    
    - 대규모 시스템 설계에 적합하다.
  
  - 단점
    
    - 초기 단계에서 모든 요구사항을 명확히 정의해야 하므로 시간이 많이 걸릴 수 있다.
    
    - 세부 요구사항이 빠질 가능성이 있어 조심해야 한다.

- 상향식(BOTTOM-UP)
  
  - 작은 구성 요소(세부적인 데이터)에서 출발하여 점차 전체 구조를 만들어가는 방법이다.
  
  - 먼저 데이터를 정의하고, 이를 조합하여 더 큰 구조(엔티티와 관계)를 설계한다.
  
  - 장점
    
    - 기존 시스템 또는 데이터로부터 시작하기 때문에 현실적인 설계가 가능하다.
    
    - 세부적인 데이터 요구사항을 먼저 반영하여 데이터 누락의 위험이 적다.
  
  - 단점
    
    - 초기 단계에서 전체적인 구조가 불명확할 수 있다.
    
    - 설계의 일관성을 유지하기 어렵고 통합 과정에서 문제가 발생할 가능성이 높다.

- 실제로는 **하향식과 상향식을 혼합하여 사용**하는 경우가 많다.

- **하향식** 접근을 통해 큰 구조와 주요 엔터티를 설계한 뒤, **상향식** 접근으로 세부 데이터를 통합하고 검토하는 방식이 일반적이다.

### 주의사항

- 각 엔티티 설계에 대한 명확한 근거가 필요하다.

- 추가되는 요구사항을 반영할 수 있게 설계해야 한다.

- 자주 사용하는 쿼리를 고려하여 테이블 구조를 최적화한다.
